source code borrowed from http://webpy.org/src/blog/0.3
